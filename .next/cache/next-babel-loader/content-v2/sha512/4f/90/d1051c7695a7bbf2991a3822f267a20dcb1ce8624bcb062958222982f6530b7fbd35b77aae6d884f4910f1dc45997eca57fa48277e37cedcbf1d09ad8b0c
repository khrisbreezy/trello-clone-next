{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useRef } from 'react';\nimport Board, { createTranslate } from 'react-trello';\nimport Router from 'next/router';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { CSVLink } from 'react-csv';\nimport { savePhaseData } from '../store/actions/phaseStore';\n\nconst Home = () => {\n  const dispatch = useDispatch();\n  const btnRef = useRef();\n  const thePhaseData = useSelector(state => state.phaseData.phases);\n  const {\n    0: mapName,\n    1: setMapName\n  } = useState('Map Name');\n  const {\n    0: phaseData,\n    1: setPhaseData\n  } = useState(thePhaseData);\n  const {\n    0: csvData,\n    1: setCsvData\n  } = useState([]);\n  const TEXTS = {\n    \"Add another lane\": \"+ Add Phase\",\n    \"Click to add card\": \"Add actions\",\n    \"Delete lane\": \"Delete phase\",\n    \"Lane actions\": \"Phase actions\",\n    \"button\": {\n      \"Add lane\": \"Add Phase\",\n      \"Add card\": \"Add Phase\",\n      \"Cancel\": \"Cancel\"\n    },\n    \"placeholder\": {\n      \"title\": \"action\",\n      \"description\": \"responsible\",\n      \"label\": \"label\"\n    }\n  };\n\n  const mapNameHandler = e => {\n    setMapName(e.target.value);\n  };\n\n  const headers = [{\n    label: 'Phase',\n    key: 'phase'\n  }, {\n    label: 'Action',\n    key: 'action'\n  }, {\n    label: 'Responsible',\n    key: 'responsible'\n  }];\n  const csvReport = {\n    filename: mapName.split(' ').join('-') + '.csv',\n    headers: headers,\n    data: csvData\n  };\n  const data = {\n    lanes: phaseData\n  };\n\n  const dataChange = data => {\n    setPhaseData(data.lanes);\n    dispatch(savePhaseData([]));\n  };\n\n  const gotoProcessBginfoHandler = () => {\n    dispatch(savePhaseData(phaseData));\n    Router.push('/process-background-information');\n  };\n\n  const exportDataHandler = async () => {\n    let dataToExport = [];\n    phaseData.forEach(phase => {\n      phase.cards.forEach(card => {\n        dataToExport.push({\n          'phase': phase.title,\n          'action': card.title,\n          'responsible': card.description\n        });\n      });\n    });\n    await setCsvData(dataToExport);\n    btnRef.current.link.click();\n    dispatch(savePhaseData([])); // setPhaseData([]);\n  };\n\n  return /*#__PURE__*/_jsx(\"section\", {\n    className: \"page_manager\",\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"container-fluid\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-12 text-center\",\n          children: /*#__PURE__*/_jsx(\"input\", {\n            className: \"mapName_input\",\n            type: \"text\",\n            value: mapName,\n            onChange: mapNameHandler\n          })\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsx(Board, {\n          data: data,\n          editable: true,\n          editLaneTitle: true,\n          canAddLanes: true,\n          onDataChange: dataChange,\n          t: createTranslate(TEXTS)\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row mb-5 text-center\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"col-md-6\",\n          children: /*#__PURE__*/_jsx(\"button\", {\n            onClick: gotoProcessBginfoHandler,\n            className: \"btn\",\n            children: \"Add process background\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"col-md-6\",\n          children: [/*#__PURE__*/_jsx(CSVLink, _objectSpread(_objectSpread({\n            className: \"d-none\",\n            ref: btnRef\n          }, csvReport), {}, {\n            children: \"Export\"\n          })), /*#__PURE__*/_jsx(\"button\", {\n            onClick: exportDataHandler,\n            className: \"btn\",\n            children: \"Export to data frame\"\n          })]\n        })]\n      })]\n    })\n  });\n};\n\nexport default Home;","map":null,"metadata":{},"sourceType":"module"}