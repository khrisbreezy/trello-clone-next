{"ast":null,"code":"import _defineProperty from \"/Users/macbookpro/Desktop/Projects/React-Projects/trello-clone/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/macbookpro/Desktop/Projects/React-Projects/trello-clone/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/macbookpro/Desktop/Projects/React-Projects/trello-clone/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/macbookpro/Desktop/Projects/React-Projects/trello-clone/pages/index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useRef } from 'react';\nimport Board, { createTranslate } from 'react-trello';\nimport Router from 'next/router';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { CSVLink } from 'react-csv';\nimport { NotificationManager } from 'react-notifications';\nimport Cookies from 'js-cookie';\nimport { savePhaseData } from '../store/actions/phaseStore';\nimport { logout } from '../store/actions/auth';\nimport axiosInstance from '../config/axios';\n\nvar Home = function Home() {\n  _s();\n\n  var dispatch = useDispatch();\n  var btnRef = useRef();\n  var thePhaseData = useSelector(function (state) {\n    return state.phaseData.phases;\n  });\n  var loggedIn = useSelector(function (state) {\n    return state.auth.loggedIn;\n  });\n  var user = Cookies.get('user') || null;\n  user = typeof user === 'object' ? user : JSON.parse(user);\n  var token = Cookies.get('token');\n\n  var _useState = useState('Map Name'),\n      mapName = _useState[0],\n      setMapName = _useState[1];\n\n  var _useState2 = useState(thePhaseData),\n      phaseData = _useState2[0],\n      setPhaseData = _useState2[1];\n\n  var _useState3 = useState([]),\n      csvData = _useState3[0],\n      setCsvData = _useState3[1];\n\n  var TEXTS = {\n    \"Add another lane\": \"+ Add Phase\",\n    \"Click to add card\": \"Add actions\",\n    \"Delete lane\": \"Delete phase\",\n    \"Lane actions\": \"Phase actions\",\n    \"button\": {\n      \"Add lane\": \"Add Phase\",\n      \"Add card\": \"Add Action\",\n      \"Cancel\": \"Cancel\"\n    },\n    \"placeholder\": {\n      \"title\": \"action\",\n      \"description\": \"responsible\",\n      \"label\": \"label\"\n    }\n  };\n\n  var mapNameHandler = function mapNameHandler(e) {\n    setMapName(e.target.value);\n  };\n\n  var headers = [{\n    label: 'Phase',\n    key: 'phase'\n  }, {\n    label: 'Action',\n    key: 'action'\n  }, {\n    label: 'Responsible',\n    key: 'responsible'\n  }];\n  var csvReport = {\n    filename: mapName.split(' ').join('-') + '.csv',\n    headers: headers,\n    data: csvData\n  };\n  var data = {\n    lanes: phaseData\n  };\n\n  var dataChange = function dataChange(data) {\n    setPhaseData(data.lanes);\n    dispatch(savePhaseData([]));\n  };\n\n  var gotoProcessBginfoHandler = function gotoProcessBginfoHandler() {\n    dispatch(savePhaseData(phaseData));\n    Router.push('/process-background-information');\n  };\n\n  var sendDataToDatase = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var phase, _yield$axiosInstance$, _data, dataToExport;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              phase = [];\n              data.lanes.map(function (lane) {\n                phase.push({\n                  'title': lane.title,\n                  'card': lane.cards.map(function (card) {\n                    return {\n                      'action': card.title,\n                      'responsibility': card.description\n                    };\n                  })\n                });\n                console.log({\n                  phase: phase\n                });\n              });\n              _context.prev = 2;\n              _context.next = 5;\n              return axiosInstance.post('processes', {\n                process_name: mapName,\n                user_id: user.id,\n                phase: phase\n              }, {\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n\n            case 5:\n              _yield$axiosInstance$ = _context.sent;\n              _data = _yield$axiosInstance$.data;\n              console.log({\n                data: _data\n              });\n              dataToExport = [];\n              phaseData.forEach(function (phase) {\n                phase.cards.forEach(function (card) {\n                  dataToExport.push({\n                    'phase': phase.title,\n                    'action': card.title,\n                    'responsible': card.description\n                  });\n                });\n              });\n              _context.next = 12;\n              return setCsvData(dataToExport);\n\n            case 12:\n              btnRef.current.link.click();\n              dispatch(savePhaseData([]));\n              _context.next = 19;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0);\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 16]]);\n    }));\n\n    return function sendDataToDatase() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var exportDataHandler = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (loggedIn) {\n                _context2.next = 3;\n                break;\n              }\n\n              $('#authModal').modal('show');\n              return _context2.abrupt(\"return\");\n\n            case 3:\n              _context2.next = 5;\n              return sendDataToDatase();\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function exportDataHandler() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var loginHandler = function loginHandler() {\n    $('#authModal').modal('show');\n  };\n\n  var loginOutHandler = function loginOutHandler() {\n    dispatch(logout());\n    NotificationManager.success('Logout successfully', '', 5000);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"page_manager\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 text-center d-flex align-items-center justify-content-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"mapName_input mx-3\",\n            type: \"text\",\n            value: mapName,\n            onChange: mapNameHandler\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 25\n          }, _this), !loggedIn ? /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: loginHandler,\n            className: \"btn btn-login\",\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 25\n          }, _this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: loginOutHandler,\n            className: \"btn btn-login\",\n            children: \"Logout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(Board, {\n          data: data,\n          editable: true,\n          editLaneTitle: true,\n          canAddLanes: true,\n          onDataChange: dataChange,\n          t: createTranslate(TEXTS)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 20\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-6 mb-4\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: gotoProcessBginfoHandler,\n            className: \"btn\",\n            children: \"Add process background\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 25\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-6 mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(CSVLink, _objectSpread(_objectSpread({\n            className: \"d-none\",\n            ref: btnRef\n          }, csvReport), {}, {\n            children: \"Export\"\n          }), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: exportDataHandler,\n            className: \"btn\",\n            children: \"Export to data frame\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 21\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(Home, \"jgxym/XovVHgwbgxbFAzOjeJzIk=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/macbookpro/Desktop/Projects/React-Projects/trello-clone/pages/index.js"],"names":["React","useState","useRef","Board","createTranslate","Router","useSelector","useDispatch","CSVLink","NotificationManager","Cookies","savePhaseData","logout","axiosInstance","Home","dispatch","btnRef","thePhaseData","state","phaseData","phases","loggedIn","auth","user","get","JSON","parse","token","mapName","setMapName","setPhaseData","csvData","setCsvData","TEXTS","mapNameHandler","e","target","value","headers","label","key","csvReport","filename","split","join","data","lanes","dataChange","gotoProcessBginfoHandler","push","sendDataToDatase","phase","map","lane","title","cards","card","description","console","log","post","process_name","user_id","id","Authorization","dataToExport","forEach","current","link","click","exportDataHandler","$","modal","loginHandler","loginOutHandler","success"],"mappings":"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","sourcesContent":["\nimport React, { useState, useRef } from 'react';\nimport Board, { createTranslate } from 'react-trello';\nimport Router from 'next/router';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { CSVLink } from 'react-csv';\nimport {NotificationManager} from 'react-notifications';\nimport Cookies from 'js-cookie';\n\nimport { savePhaseData } from '../store/actions/phaseStore';\nimport { logout } from '../store/actions/auth';\nimport axiosInstance from '../config/axios';\n\n\nconst Home = () => {\n\n    const dispatch = useDispatch();\n    const btnRef = useRef();\n\n    const thePhaseData = useSelector(state => state.phaseData.phases);\n    const loggedIn = useSelector(state => state.auth.loggedIn);\n    let user = Cookies.get('user') || null;\n    user = typeof user === 'object' ? user : JSON.parse(user);\n    const token = Cookies.get('token');\n\n    const [ mapName, setMapName ] = useState('Map Name');\n    const [phaseData, setPhaseData] = useState(thePhaseData);\n    const [csvData, setCsvData] = useState([]);\n\n    const TEXTS = {\n        \"Add another lane\": \"+ Add Phase\",  \n        \"Click to add card\": \"Add actions\",\n        \"Delete lane\": \"Delete phase\",\n        \"Lane actions\": \"Phase actions\",\n        \"button\": {\n          \"Add lane\": \"Add Phase\",\n          \"Add card\": \"Add Action\",\n          \"Cancel\": \"Cancel\"\n        },\n        \"placeholder\": {\n          \"title\": \"action\",\n          \"description\": \"responsible\",\n          \"label\": \"label\"\n        }\n    };\n\n    const mapNameHandler = (e) => {\n        setMapName(e.target.value);\n    };\n\n    const headers = [\n        {label: 'Phase', key: 'phase'},\n        {label: 'Action', key: 'action'},\n        {label: 'Responsible', key: 'responsible'}\n    ];\n\n    const csvReport = {\n        filename: mapName.split(' ').join('-') + '.csv',\n        headers: headers,\n        data: csvData\n    };\n\n    const data = {\n        lanes: phaseData\n    };\n\n    const dataChange = (data) => {\n        setPhaseData(data.lanes);\n        dispatch(savePhaseData([]));\n    };\n\n    const gotoProcessBginfoHandler = () => {\n        dispatch(savePhaseData(phaseData));\n        Router.push('/process-background-information');\n    };\n\n    const sendDataToDatase = async () => {\n        let phase = [];\n        data.lanes.map((lane => { \n            phase.push({\n                'title': lane.title,\n                'card': lane.cards.map((card) => ({\n                    'action': card.title,\n                    'responsibility': card.description\n                }))\n            });\n            \n            console.log({phase});\n        }))\n        try {\n            const { data } = await axiosInstance.post('processes', {\n                process_name: mapName, \n                user_id: user.id,\n                phase: phase\n            }, {\n                headers: {\n                    Authorization: `Bearer ${token}`\n                }\n            });\n            console.log({data});\n            let dataToExport = [];\n            phaseData.forEach(phase => {\n                phase.cards.forEach(card => {\n                    dataToExport.push({\n                        'phase': phase.title,\n                        'action': card.title,\n                        'responsible': card.description\n                    });\n                })\n            });\n\n            await setCsvData(dataToExport);\n            btnRef.current.link.click();\n            dispatch(savePhaseData([]));\n        } catch(e) {\n            console.log(e);\n        }\n    };\n\n    const exportDataHandler = async () => {\n        if (!loggedIn) {\n            $('#authModal').modal('show');\n            return;\n        }\n        await sendDataToDatase();\n    };\n\n    const loginHandler = () => {\n        $('#authModal').modal('show');\n    };\n\n    const loginOutHandler = () => {\n        dispatch(logout());\n        NotificationManager.success('Logout successfully', '', 5000);\n    }\n  \n\n    return (\n        <section className='page_manager'>\n            <div className=\"container-fluid\">  \n                <div className=\"row\">\n                    <div className=\"col-12 text-center d-flex align-items-center justify-content-center\">\n                        <input className='mapName_input mx-3' type=\"text\" value={mapName} onChange={mapNameHandler} />\n                        {!loggedIn ? \n                        <button onClick={loginHandler} className='btn btn-login'>Login</button>\n                        :\n                        <button onClick={loginOutHandler} className='btn btn-login'>Logout</button>}\n                    </div>\n                </div>\n\n                <div className=\"row\">\n                   <Board data={data}\n                    editable editLaneTitle\n                    canAddLanes onDataChange={dataChange}\n                    t={createTranslate(TEXTS)}\n                    /> \n                </div>\n\n                <div className=\"row text-center\">\n                    <div className=\"col-md-6 mb-4\">\n                        <button onClick={gotoProcessBginfoHandler} className=\"btn\">Add process background</button>\n                    </div>\n                    <div className=\"col-md-6 mb-4\">\n                        <CSVLink className='d-none' ref={btnRef} {...csvReport}>Export</CSVLink>\n                        <button onClick={exportDataHandler} className=\"btn\">Export to data frame</button>\n                    </div>         \n                </div>\n            </div>\n        </section>\n    )\n  \n};\n\nexport default Home;\n\n"]},"metadata":{},"sourceType":"module"}